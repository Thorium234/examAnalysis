{% comment %} exams/templates/admin/exams/gradingsystem/manage_ranges.html {% endcomment %}
{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block extrahead %}{{ block.super }}
<style>
    .grading-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1em;
    }
    .grading-table th, .grading-table td {
        padding: 8px;
        border: 1px solid #ddd;
        text-align: center;
    }
    .grading-table th {
        background-color: #f5f5f5;
    }
    .btn-container {
        margin-bottom: 1em;
    }
    .btn-container button {
        margin-right: 10px;
    }
    .error {
        color: red;
        margin-bottom: 1em;
    }
</style>
{% endblock %}

{% block content %}
<div id="content-main">
    <h1>{{ title }}</h1>
    
    <div class="btn-container">
        <form method="post">
            {% csrf_token %}
            <button type="submit" name="apply_sample" class="button">Load Sample Grading System</button>
            <button type="button" id="add-row" class="button">Add New Range</button>
            <button type="submit" name="save" class="default" style="float: right;">Save Changes</button>
        </form>
    </div>

    <form method="post" id="grading-form">
        {% csrf_token %}
        <table class="grading-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Low Mark</th>
                    <th>High Mark</th>
                    <th>Grade</th>
                    <th>Points</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="ranges-tbody">
                {% for range in ranges %}
                <tr data-id="{{ range.id }}">
                    <td>{{ forloop.counter }}</td>
                    <td>
                        <input type="number" name="low_mark_{{ range.id }}" value="{{ range.low_mark }}" 
                               min="0" max="100" required>
                    </td>
                    <td>
                        <input type="number" name="high_mark_{{ range.id }}" value="{{ range.high_mark }}"
                               min="0" max="100" required>
                    </td>
                    <td>
                        <input type="text" name="grade_{{ range.id }}" value="{{ range.grade }}"
                               maxlength="2" required>
                    </td>
                    <td>
                        <input type="number" name="points_{{ range.id }}" value="{{ range.points }}"
                               min="0" max="12" required>
                    </td>
                    <td>
                        <button type="button" class="delete-row" onclick="deleteRow(this)">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </form>
</div>

{% block admin_change_form_document_ready %}
<script>
    function deleteRow(button) {
        if (confirm('Are you sure you want to delete this range?')) {
            button.closest('tr').remove();
            updateRowNumbers();
        }
    }

    function updateRowNumbers() {
        const rows = document.querySelectorAll('#ranges-tbody tr');
        rows.forEach((row, index) => {
            row.querySelector('td:first-child').textContent = index + 1;
        });
    }

    document.getElementById('add-row').addEventListener('click', function() {
        const tbody = document.getElementById('ranges-tbody');
        const newRow = document.createElement('tr');
        const rowNum = tbody.children.length + 1;
        
        newRow.innerHTML = `
            <td>${rowNum}</td>
            <td><input type="number" name="new_low_mark_${rowNum}" min="0" max="100" required></td>
            <td><input type="number" name="new_high_mark_${rowNum}" min="0" max="100" required></td>
            <td><input type="text" name="new_grade_${rowNum}" maxlength="2" required></td>
            <td><input type="number" name="new_points_${rowNum}" min="0" max="12" required></td>
            <td><button type="button" class="delete-row" onclick="deleteRow(this)">Delete</button></td>
        `;
        
        tbody.appendChild(newRow);
    });
</script>
{% endblock %}
{% endblock %}

exams/bulk_paper_result_entry.html
{% comment %}  {% endcomment %}
{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
    <h2>Bulk Paper Result Entry</h2>
    
    <!-- Entry Mode Selection Form -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="post" id="entryModeForm">
                {% csrf_token %}
                
                <div class="row">
                    <div class="col-md-4">
                        {{ entry_form.exam.label_tag }}
                        {{ entry_form.exam }}
                    </div>
                    <div class="col-md-4">
                        {{ entry_form.subject.label_tag }}
                        {{ entry_form.subject }}
                    </div>
                </div>
                
                <div class="row mt-3">
                    <div class="col-12">
                        <label>Entry Mode:</label>
                        <div class="btn-group" role="group">
                            {% for value, label in entry_form.entry_mode.field.choices %}
                            <input type="radio" class="btn-check" name="{{ entry_form.entry_mode.name }}"
                                   id="mode_{{ value }}" value="{{ value }}"
                                   {% if entry_form.entry_mode.value == value %}checked{% endif %}>
                            <label class="btn btn-outline-primary" for="mode_{{ value }}">{{ label }}</label>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <!-- Dynamic Fields based on Mode -->
                <div id="normalModeFields" class="mt-3" style="display: none;">
                    <div class="row">
                        <div class="col-md-4">
                            {{ entry_form.max_marks.label_tag }}
                            {{ entry_form.max_marks }}
                            <small class="form-text text-muted">{{ entry_form.max_marks.help_text }}</small>
                        </div>
                    </div>
                </div>
                
                <div id="standardModeFields" class="mt-3" style="display: none;">
                    <div class="row">
                        <div class="col-md-4">
                            {{ entry_form.paper.label_tag }}
                            {{ entry_form.paper }}
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary mt-3">Load Students</button>
            </form>
        </div>
    </div>
    
    {% if formset %}
    <!-- Result Entry Form -->
    <div class="card">
        <div class="card-body">
            <h4>Enter Results</h4>
            <div class="table-responsive">
                <form method="post" action="{% url 'save_paper_results' %}">
                    {% csrf_token %}
                    {{ formset.management_form }}
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Admission No.</th>
                                <th>Name</th>
                                <th>Marks (out of {{ max_marks }})</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for form in formset %}
                            <tr>
                                {{ form.student }}
                                <td>{{ form.admission_number }}</td>
                                <td>{{ form.name }}</td>
                                <td>{{ form.marks }}</td>
                                <td>{{ form.status }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <button type="submit" class="btn btn-success">Save Results</button>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Spreadsheet Section -->
    <div class="card mt-4">
        <div class="card-body">
            <h4>Spreadsheet Entry</h4>
            
            <!-- Template Download -->
            <div class="mb-4">
                <h5>1. Download Template</h5>
                <p>Download a pre-formatted spreadsheet template with student information.</p>
                <button type="button" class="btn btn-primary" id="downloadTemplate">
                    <i class="fas fa-download"></i> Download Template
                </button>
            </div>
            
            <div class="mb-4">
                <h5>2. Fill in the Template</h5>
                <ul>
                    <li>Enter marks in the 'Marks' column</li>
                    <li>Use P (Present), A (Absent), or D (Disqualified) in the 'Status' column</li>
                    <li>Do not modify locked cells or sheet structure</li>
                    <li>Save the file when done</li>
                </ul>
            </div>
            
            <!-- File Upload -->
            <div>
                <h5>3. Upload Completed Spreadsheet</h5>
                <form method="post" action="{% url 'upload_spreadsheet' %}" 
                      enctype="multipart/form-data" id="spreadsheetUploadForm">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-6">
                            <input type="file" class="form-control" name="file" 
                                   accept=".xlsx" required>
                            <small class="form-text text-muted">
                                Upload the filled template without modifying its structure
                            </small>
                        </div>
                        <div class="col-md-6">
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-upload"></i> Upload & Process
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Spreadsheet template download
    $('#downloadTemplate').click(function() {
        var exam = $('#id_exam').val();
        var subject = $('#id_subject').val();
        var paper = $('#id_paper').val();
        var mode = $('input[name="entry_mode"]:checked').val();
        
        if (!exam || !subject) {
            alert('Please select exam and subject first');
            return;
        }
        
        var url = `/exams/spreadsheet/template/${exam}/${subject}/`;
        if (mode === 'standard' && paper) {
            url += `${paper}/`;
        }
        
        window.location.href = url;
    });
    
    // Spreadsheet upload handling
    $('#spreadsheetUploadForm').submit(function(e) {
        e.preventDefault();
        var formData = new FormData(this);
        
        $.ajax({
            url: $(this).attr('action'),
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
                if (response.success) {
                    alert('Successfully processed ' + response.count + ' results');
                    location.reload();
                } else {
                    alert('Error: ' + response.error);
                }
            },
            error: function(xhr) {
                alert('Error: ' + xhr.responseJSON.error);
            }
        });
    });
    function updateModeFields() {
        var mode = $('input[name="entry_mode"]:checked').val();
        $('#normalModeFields').toggle(mode === 'normal');
        $('#standardModeFields').toggle(mode === 'standard');
    }
    
    // Initial state
    updateModeFields();
    
    // Mode change handler
    $('input[name="entry_mode"]').change(updateModeFields);
    
    // Subject change handler - update papers
    $('#id_subject').change(function() {
        var subjectId = $(this).val();
        if (subjectId) {
            $.get('/api/subject/' + subjectId + '/papers/', function(data) {
                var paperSelect = $('#id_paper');
                paperSelect.empty();
                data.forEach(function(paper) {
                    paperSelect.append(new Option(paper.name, paper.id));
                });
            });
        }
    });
    
    // Status change handler
    $('.status-select').change(function() {
        var row = $(this).closest('tr');
        var marksInput = row.find('input[type="number"]');
        if ($(this).val() !== 'P') {
            marksInput.prop('disabled', true).val('');
        } else {
            marksInput.prop('disabled', false);
        }
    });
});
</script>
{% endblock %}

exams/templates/exams/create_exam.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Exam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="antialiased flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">Create New Exam</h1>
        
        <form method="post" action="{% url 'exams:create_exam' %}">
            {% csrf_token %}
            
            {% for field in form %}
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-gray-700 font-medium mb-2">
                    {{ field.label }}
                </label>
                {{ field }}
                {% if field.help_text %}
                    <p class="text-sm text-gray-500 mt-1">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="text-red-500 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>
            {% endfor %}

            <div class="flex items-center justify-between mt-6">
                <button type="submit" class="bg-indigo-600 text-white font-semibold py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300 w-full focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                    Create Exam
                </button>
            </div>
        </form>
    </div>
</body>
</html> 

exams/templates/exams/enter_results.html
{% extends 'base.html' %}{% block title %}Enter Results - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Enter Results for {{ exam.name }}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="POST" action="{% url 'exams:add_result' exam.id %}" class="space-y-6">
        {% csrf_token %}
        <div>
            <label for="student" class="block text-sm font-medium text-gray-700">Student</label>
            <select id="student" name="student" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                <option value="">Select a student</option>
                {% for student in students %}
                <option value="{{ student.id }}">{{ student.full_name }} ({{ student.admission_number }})</option>
                {% endfor %}
            </select>
        </div>
        
        <div>
            <label for="subject" class="block text-sm font-medium text-gray-700">Subject</label>
            <select id="subject" name="subject" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                <option value="">Select a subject</option>
                {% for subject in subjects %}
                <option value="{{ subject.id }}">{{ subject.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div>
            <label for="marks" class="block text-sm font-medium text-gray-700">Marks</label>
            <input type="number" id="marks" name="marks" required min="0" max="100" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Enter marks (e.g., 85)">
        </div>
        
        <div class="flex justify-end space-x-4">
            <button type="button" onclick="window.history.back()" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</button>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Save Result
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/exam_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete the exam "<strong>{{ object.name }}</strong>"?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone and will delete all associated data.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:exam_detail' pk=object.pk %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}

exams/templates/exams/exam_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete the exam "<strong>{{ object.name }}</strong>"?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone and will delete all associated data.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:exam_detail' pk=object.pk %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/exam_detail_report.html
{% extends 'base.html' %}{% block title %}Exam Detail - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-2 text-center text-blue-800">{{ exam.name }} - Summary Report</h1><p class="text-center text-lg text-gray-600 mb-6">Form(s) {% for form in exam.participating_forms.all %}{{ form.number }}{% if not forloop.last %}, {% endif %}{% endfor %}, {{ exam.get_term_display }} {{ exam.year }}</p><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
    <div class="bg-blue-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-blue-800">Student Count</h3>
        <p class="text-2xl font-bold text-blue-600">{{ exam.student_summaries.count }}</p>
    </div> 
    <div class="bg-green-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-green-800">Overall Mean Grade</h3>
        <p class="text-2xl font-bold text-green-600">
            {{ exam.student_summaries.all|first.mean_grade|default:"N/A" }}
        </p>
    </div>
    <div class="bg-yellow-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-yellow-800">Highest Score</h3>
        <p class="text-2xl font-bold text-yellow-600">
            {% with max_summary=exam.student_summaries.all|first %}
                {{ max_summary.total_marks|default:"N/A" }} ({{ max_summary.student.full_name|default:"N/A" }})
            {% endwith %}
        </p>
    </div>
    <div class="bg-red-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-red-800">Lowest Score</h3>
        <p class="text-2xl font-bold text-red-600">
            {% with min_summary=exam.student_summaries.all|last %}
                {{ min_summary.total_marks|default:"N/A" }} ({{ min_summary.student.full_name|default:"N/A" }})
            {% endwith %}
        </p>
    </div>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Adm No</th>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stream</th>
                {% for subject in subjects %}
                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">{{ subject_map.get(subject.name, subject.name) }}</th>
                {% endfor %}
                {% for header in summary_headers.values %}
                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">{{ header }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for student_data in student_data_list %}
            <tr>
                <td class="px-2 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ student_data.admission_no }}</td>
                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-900">{{ student_data.name }}</td>
                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500">{{ student_data.stream }}</td>
                {% for subject in subjects %}
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">
                    {{ student_data.subject_marks.get(subject.name, '-') }}
                </td>
                {% endfor %}
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.total_marks|floatformat:"2" }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.mean_marks|floatformat:"2" }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.num_subjects }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.mean_grade }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.total_points }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.stream_position }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.class_position }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="mt-8 flex justify-center space-x-4">
    <a href="{% url 'exams:upload_results' exam.id %}" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Upload Results
    </a>
    <a href="{% url 'exams:download_csv_report' exam.id %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Download CSV
    </a>
    <a href="{% url 'exams:download_pdf_report' exam.id %}" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Download PDF
    </a>
</div>
</div>{% endblock %}
exams/templates/exams/exam_detail.html
{% extends 'base.html' %}{% block title %}Exam Detail - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-2 text-center text-blue-800">{{ exam.name }} - Summary Report</h1><p class="text-center text-lg text-gray-600 mb-6">Form(s) {% for form in exam.participating_forms.all %}{{ form.number }}{% if not forloop.last %}, {% endif %}{% endfor %}, {{ exam.get_term_display }} {{ exam.year }}</p><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
    <div class="bg-blue-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-blue-800">Student Count</h3>
        <p class="text-2xl font-bold text-blue-600">{{ exam.student_summaries.count }}</p>
    </div> 
    <div class="bg-green-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-green-800">Overall Mean Grade</h3>
        <p class="text-2xl font-bold text-green-600">
            {{ exam.student_summaries.all|first.mean_grade|default:"N/A" }}
        </p>
    </div>
    <div class="bg-yellow-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-yellow-800">Highest Score</h3>
        <p class="text-2xl font-bold text-yellow-600">
            {% with max_summary=exam.student_summaries.all|first %}
                {{ max_summary.total_marks|default:"N/A" }} ({{ max_summary.student.full_name|default:"N/A" }})
            {% endwith %}
        </p>
    </div>
    <div class="bg-red-100 p-4 rounded-xl shadow-md text-center">
        <h3 class="text-xl font-semibold text-red-800">Lowest Score</h3>
        <p class="text-2xl font-bold text-red-600">
            {% with min_summary=exam.student_summaries.all|last %}
                {{ min_summary.total_marks|default:"N/A" }} ({{ min_summary.student.full_name|default:"N/A" }})
            {% endwith %}
        </p>
    </div>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Adm No</th>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th class="px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stream</th>
                {% for subject in subjects %}
                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">{{ subject_map.get(subject.name, subject.name) }}</th>
                {% endfor %}
                {% for header in summary_headers.values %}
                <th class="px-2 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">{{ header }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for student_data in student_data_list %}
            <tr>
                <td class="px-2 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ student_data.admission_no }}</td>
                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-900">{{ student_data.name }}</td>
                <td class="px-2 py-4 whitespace-nowrap text-sm text-gray-500">{{ student_data.stream }}</td>
                {% for subject in subjects %}
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">
                    {{ student_data.subject_marks.get(subject.name, '-') }}
                </td>
                {% endfor %}
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.total_marks|floatformat:"2" }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.mean_marks|floatformat:"2" }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.num_subjects }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.mean_grade }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.total_points }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.stream_position }}</td>
                <td class="px-2 py-4 text-center whitespace-nowrap text-sm text-gray-900">{{ student_data.class_position }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="mt-8 flex justify-center space-x-4">
    <a href="{% url 'exams:upload_results' exam.id %}" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Upload Results
    </a>
    <a href="{% url 'exams:download_csv_report' exam.id %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Download CSV
    </a>
    <a href="{% url 'exams:download_pdf_report' exam.id %}" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full shadow-md transition-colors duration-300">
        Download PDF
    </a>
</div>
</div>{% endblock %}

exams/templates/exams/exam_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Exam{% else %}Create Exam{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Exam{% else %}Create New Exam{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% for field in form %} 
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700">{{ field.label }}</label>
                <div class="mt-1">
                    {{ field }}
                </div>
                {% if field.help_text %}
                    <p class="mt-2 text-sm text-gray-500">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}
        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:exam_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %} Exam
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/exam_list.html
{% extends 'base.html' %}{% block title %}Exams{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Exam List</h1><div class="bg-white p-6 rounded-xl shadow-lg mb-6">
    <form method="GET" action="{% url 'exams:exam_list' %}" class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
        <div>
            <label for="form_level" class="block text-sm font-medium text-gray-700">Filter by Form</label>
            <select name="form_level" id="form_level" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                <option value="">All</option>
                {% for form in form_levels %}
                <option value="{{ form.pk }}" {% if selected_form|stringformat:"s" == form.pk|stringformat:"s" %}selected{% endif %}>Form {{ form.number }}</option>
                {% endfor %}
            </select> 
        </div>
        <div>
            <label for="year" class="block text-sm font-medium text-gray-700">Filter by Year</label>
            <select name="year" id="year" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                <option value="">All</option>
                {% for year in years %}
                <option value="{{ year }}" {% if selected_year|stringformat:"s" == year|stringformat:"s" %}selected{% endif %}>{{ year }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label for="term" class="block text-sm font-medium text-gray-700">Filter by Term</label>
            <select name="term" id="term" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                <option value="">All</option>
                {% for term_value, term_label in terms %}
                <option value="{{ term_value }}" {% if selected_term|stringformat:"s" == term_value|stringformat:"s" %}selected{% endif %}>{{ term_label }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md shadow-md transition-colors duration-300">
                Filter
            </button>
        </div>
    </form>
</div>

{% if exams %}
<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Year</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Term</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Form(s)</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for exam in exams %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ exam.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ exam.year }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ exam.get_term_display }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    {% for form in exam.participating_forms.all %}
                        {{ form.number }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ exam.get_exam_type_display }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <a href="{% url 'exams:exam_detail' pk=exam.id %}" class="text-blue-600 hover:text-blue-900 mr-4">View Report</a>
                    <a href="{% url 'exams:exam_update' pk=exam.id %}" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</a>
                    <a href="{% url 'exams:exam_delete' pk=exam.id %}" class="text-red-600 hover:text-red-900">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p class="text-center text-gray-500">No exams found.</p>
{% endif %}

<div class="mt-6 text-center">
    <a href="{% url 'exams:exam_create' %}" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Create New Exam
    </a>
</div>
</div>{% endblock %}

exams/templates/exams/exam_summary_report.html
{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div class="container-fluid my-4">
    <div class="row">
        <div class="col-md-8">
            <h1 class="h3 mb-2 text-gray-800"> 
                {{ exam.name }} - Summary Report
            </h1>
            <p class="mb-4">
                Form: {{ exam.form_level }} &nbsp;&nbsp;|&nbsp;&nbsp; Exam Type: {{ exam.get_exam_type_display }}
            </p>
        </div>
        <div class="col-md-4 text-right">
            <a href="{% url 'exams:download_csv_report' exam.id %}" class="btn btn-primary">
                <i class="fas fa-file-csv"></i> Download CSV
            </a>
            <a href="{% url 'exams:download_pdf_report' exam.id %}" class="btn btn-danger">
                <i class="fas fa-file-pdf"></i> Download PDF
            </a>
        </div>
    </div>
    
    <div class="card shadow mb-4">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-bordered" id="results-table">
                    <thead>
                        <tr>
                            <th>Admission No</th>
                            <th>Student Name</th>
                            <th>Stream</th>
                            {% for subject in subjects %}
                            <th>{{ subject_map|get_item:subject.name|default:subject.name|upper }}</th>
                            {% endfor %}
                            <th>Total Marks</th>
                            <th>Mean Marks</th>
                            <th>No. of Subjects</th>
                            <th>Grade</th>
                            <th>Total Points</th>
                            <th>Stream Position</th>
                            <th>Class Position</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for summary in student_summaries %}
                        <tr data-stream="{{ summary.student.stream }}">
                            <td>{{ summary.student.admission_number }}</td>
                            <td>{{ summary.student.full_name }}</td>
                            <td>{{ summary.student.stream }}</td>
                            {% for subject in subjects %}
                            <td class="text-center">
                                {% with marks=student_results|get_item:summary.student.id|get_item:subject.name %}
                                {{ marks|default_if_none:"-" }}
                                {% endwith %}
                            </td>
                            {% endfor %}
                            <td>{{ summary.total_marks }}</td>
                            <td>{{ summary.mean_marks }}</td>
                            <td>{{ summary.subjects_count }}</td>
                            <td>{{ summary.mean_grade }}</td>
                            <td>{{ summary.total_points }}</td>
                            <td>{{ summary.stream_position }}</td>
                            <td>{{ summary.overall_position }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- DataTables CSS and JS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.js"></script>

<script>
    $(document).ready(function() {
        // Initialize DataTables on your table with the ID "results-table"
        $('#results-table').DataTable({
            "paging": true,
            "ordering": true,
            "info": true,
            "searching": true,
            // Optional: configure sorting behavior
            "order": [[10, "asc"]], // Sort by Class Position (11th column, index 10) by default
        });
    });
</script>
{% endblock %}
exams/templates/exams/formlevel_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete Form Level "<strong>{{ object.number }}</strong>"?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:formlevel_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}

exams/templates/exams/formlevel_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Form Level{% else %}Create Form Level{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Form Level{% else %}Create New Form Level{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% for field in form %}
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700">{{ field.label }}</label>
                <div class="mt-1">
                    {{ field }}
                </div>
                {% if field.help_text %}
                    <p class="mt-2 text-sm text-gray-500">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}
        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:formlevel_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %}
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}

exams/templates/exams/formlevel_list.html
{% extends 'base.html' %}{% block title %}Form Levels{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Form Levels</h1><div class="flex justify-end mb-6">
    <a href="{% url 'exams:formlevel_create' %}" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Create New Form Level
    </a>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    {% if form_levels %}
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Number</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for form_level in form_levels %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ form_level.number }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <a href="{% url 'exams:formlevel_update' pk=form_level.id %}" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</a>
                    <a href="{% url 'exams:formlevel_delete' pk=form_level.id %}" class="text-red-600 hover:text-red-900">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-500">No form levels found.</p>
    {% endif %}
</div>
</div>{% endblock %}
exams/templates/exams/gradingrange_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete this grading range?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:gradingsystem_detail' pk=object.grading_system.pk %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/gradingrange_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Grading Range{% else %}Create Grading Range{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Grading Range{% else %}Create New Grading Range{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% for field in form %}
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700">{{ field.label }}</label>
                <div class="mt-1">
                    {{ field }}
                </div>
                {% if field.help_text %}
                    <p class="mt-2 text-sm text-gray-500">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}
        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:gradingsystem_detail' pk=form.instance.grading_system.pk %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %}
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/gradingsystem_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete the grading system "<strong>{{ object.name }}</strong>"?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone and will also delete all associated grading ranges.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:gradingsystem_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/gradingsystem_detail.html
{% extends 'base.html' %}{% block title %}Grading System: {{ gradingsystem.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><div class="bg-white shadow-lg rounded-lg p-6 mb-8"><div class="flex justify-between items-center mb-4"><h1 class="text-3xl font-bold text-gray-800">{{ gradingsystem.name }}</h1><a href="{% url 'exams:gradingsystem_update' pk=gradingsystem.pk %}" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 ease-in-out">Edit System</a></div><p class="text-gray-600 mb-6">{{ gradingsystem.description }}</p>    <h2 class="text-2xl font-semibold text-gray-700 mb-4">Grading Ranges</h2>
    <div class="overflow-x-auto">
        <table class="min-w-full bg-white rounded-lg shadow-md">
            <thead>
                <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                    <th class="py-3 px-6 text-left">Grade</th>
                    <th class="py-3 px-6 text-left">Min. Marks</th>
                    <th class="py-3 px-6 text-left">Max. Marks</th>
                    <th class="py-3 px-6 text-left">Points</th>
                    <th class="py-3 px-6 text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="text-gray-600 text-sm font-light">
                {% for range in gradingsystem.gradingrange_set.all %}
                <tr class="border-b border-gray-200 hover:bg-gray-100">
                    <td class="py-3 px-6 text-left whitespace-nowrap">{{ range.grade }}</td>
                    <td class="py-3 px-6 text-left">{{ range.min_marks }}</td>
                    <td class="py-3 px-6 text-left">{{ range.max_marks }}</td>
                    <td class="py-3 px-6 text-left">{{ range.points }}</td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex item-center justify-center">
                            <a href="{% url 'exams:gradingrange_update' pk=range.pk %}" class="w-4 mr-2 transform hover:text-blue-500 hover:scale-110">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                </svg>
                            </a>
                            <a href="{% url 'exams:gradingrange_delete' pk=range.pk %}" class="w-4 mr-2 transform hover:text-red-500 hover:scale-110">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="mt-6">
        <a href="{% url 'exams:gradingrange_create' %}" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 ease-in-out">
            Add Grading Range
        </a>
    </div>
</div>

<div class="text-center">
    <a href="{% url 'exams:gradingsystem_list' %}" class="text-blue-500 hover:underline">
         Back to Grading Systems
    </a>
</div>
</div>{% endblock %}
exams/templates/exams/gradingsystem_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Grading System{% else %}Create Grading System{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Grading System{% else %}Create New Grading System{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% for field in form %}
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700">{{ field.label }}</label>
                <div class="mt-1">
                    {{ field }}
                </div>
                {% if field.help_text %}
                    <p class="mt-2 text-sm text-gray-500">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}
        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:gradingsystem_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %}
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/gradingsystem_list.html
{% extends 'base.html' %}{% block title %}Grading Systems{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Grading Systems</h1><div class="flex justify-end mb-6">
    <a href="{% url 'exams:gradingsystem_create' %}" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Create New System
    </a>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    {% if systems %}
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Is Default</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for system in systems %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ system.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ system.category }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                    {% if system.is_default %}Yes{% else %}No{% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <a href="{% url 'exams:gradingsystem_update' pk=system.id %}" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</a>
                    <a href="{% url 'exams:gradingsystem_delete' pk=system.id %}" class="text-red-600 hover:text-red-900">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-500">No grading systems found.</p>
    {% endif %}
</div>
</div>{% endblock %}
exams/templates/exams/paperresult_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete the paper result for **{{ result.student.full_name }}** in **{{ result.subject.name }}**, Paper **{{ result.paper.name }}**?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:paper_result_list' exam.id %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/paperresult_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Paper Result{% else %}Create Paper Result{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Paper Result for {{ exam.name }}{% else %}Create New Paper Result for {{ exam.name }}{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% if not form.instance.pk %}
            <div>
                <label for="student" class="block text-sm font-medium text-gray-700">Student</label>
                <select id="student" name="student" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    <option value="">Select a student</option>
                    {% for student in students %}
                    <option value="{{ student.id }}">{{ student.full_name }} ({{ student.admission_number }})</option>
                    {% endfor %}
                </select>
            </div>
            
            <div>
                <label for="subject" class="block text-sm font-medium text-gray-700">Subject</label>
                <select id="subject" name="subject" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    <option value="">Select a subject</option>
                    {% for subject in subjects %}
                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label for="paper" class="block text-sm font-medium text-gray-700">Paper</label>
                <select id="paper" name="paper" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                    <option value="">Select a paper</option>
                    <!-- Options will be populated via JavaScript or another method based on subject selection -->
                </select>
            </div>
        {% else %}
            <p class="mb-4 text-center text-gray-700">Editing result for **{{ result.student.full_name }}** in **{{ result.subject.name }}**, Paper **{{ result.paper.name }}**.</p>
            <div class="mb-4">
                <label for="marks" class="block text-sm font-medium text-gray-700">Marks</label>
                <input type="number" id="marks" name="marks" value="{{ result.marks }}" required min="0" max="100" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Enter marks">
            </div>
        {% endif %}

        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:paper_result_list' exam.id %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %}
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}
exams/templates/exams/paperresult_list.html
{% extends 'base.html' %}{% block title %}Paper Results - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Paper Results for {{ exam.name }}</h1><div class="flex justify-end mb-6">
    <a href="{% url 'exams:paper_result_create' exam.id %}" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Add New Paper Result
    </a>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    {% if results %}
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Student Name</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subject</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Paper</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Marks</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for result in results %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ result.student.full_name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ result.subject.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ result.paper.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ result.marks }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <a href="{% url 'exams:paper_result_update' exam.id result.id %}" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</a>
                    <a href="{% url 'exams:paper_result_delete' exam.id result.id %}" class="text-red-600 hover:text-red-900">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-500">No paper results found for this exam.</p>
    {% endif %}
</div>

<div class="mt-8 text-center">
    <a href="{% url 'exams:exam_detail' exam.id %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Back to Exam Report
    </a>
</div>
</div>{% endblock %}
exams/templates/exams/subject_analysis.html
{% extends 'base.html' %}{% block title %}Subject Analysis - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Subject Performance Analysis for {{ exam.name }}</h1><div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    {% if subject_stats %}
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Subject</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Students</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Marks</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Min Marks</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Max Marks</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Distinctions</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Credits</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Passes</th>
                <th scope="col" class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Fails</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for stat in subject_stats %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ stat.subject__name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ stat.total_students }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ stat.avg_marks|floatformat:"2" }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ stat.min_marks }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center">{{ stat.max_marks }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600 font-semibold text-center">{{ stat.distinctions }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-yellow-600 font-semibold text-center">{{ stat.credits }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-blue-600 font-semibold text-center">{{ stat.passes }}</td>
                <td class="px-6 py-4 whitespace-now-wrap text-sm text-red-600 font-semibold text-center">{{ stat.fails }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-500">No subject analysis data available for this exam.</p>
    {% endif %}
</div>

<div class="mt-8 text-center">
    <a href="{% url 'exams:exam_detail' exam.id %}" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Back to Exam Report
    </a>
</div>
</div>{% endblock %}
exams/templates/exams/subjectcategory_confirm_delete.html
{% extends 'base.html' %}{% block title %}Confirm Delete{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-lg"><h1 class="text-3xl font-bold mb-6 text-center text-red-800">Confirm Deletion</h1><div class="bg-white p-8 rounded-xl shadow-lg text-center">
    <p class="text-lg text-gray-700 mb-6">Are you sure you want to delete the subject category "<strong>{{ object.name }}</strong>"?</p>
    <p class="text-sm text-gray-500 mb-8">This action cannot be undone.</p>
    <form method="post" class="space-y-6">
        {% csrf_token %}
        <div class="flex justify-center space-x-4">
            <a href="{% url 'exams:subjectcategory_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Confirm Delete
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}

exams/templates/exams/subjectcategory_form.html
{% extends 'base.html' %}{% block title %}{% if form.instance.pk %}Edit Subject Category{% else %}Create Subject Category{% endif %}{% endblock %}{% block content %}<div class="container mx-auto p-4 max-w-2xl"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">{% if form.instance.pk %}Edit Subject Category{% else %}Create New Subject Category{% endif %}</h1><div class="bg-white p-8 rounded-xl shadow-lg">
    <form method="post" class="space-y-6">
        {% csrf_token %}
        {% for field in form %}
            <div class="mb-4">
                <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700">{{ field.label }}</label>
                <div class="mt-1">
                    {{ field }}
                </div>
                {% if field.help_text %}
                    <p class="mt-2 text-sm text-gray-500">{{ field.help_text }}</p>
                {% endif %}
                {% for error in field.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}
        <div class="flex justify-end space-x-4">
            <a href="{% url 'exams:subjectcategory_list' %}" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</a>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                {% if form.instance.pk %}Update{% else %}Create{% endif %}
            </button>
        </div>
    </form>
</div>
</div>{% endblock %}

exams/templates/exams/subjectcategory_list.html
{% extends 'base.html' %}{% block title %}Subject Categories{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Subject Categories</h1><div class="flex justify-end mb-6">
    <a href="{% url 'exams:subjectcategory_create' %}" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
        Create New Category
    </a>
</div>

<div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto">
    {% if categories %}
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for category in categories %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ category.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ category.description|default:"-" }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <a href="{% url 'exams:subjectcategory_update' pk=category.id %}" class="text-indigo-600 hover:text-indigo-900 mr-4">Edit</a>
                    <a href="{% url 'exams:subjectcategory_delete' pk=category.id %}" class="text-red-600 hover:text-red-900">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-center text-gray-500">No subject categories found.</p>
    {% endif %}
</div>
</div>{% endblock %}

exams/templates/exams/upload_results.html
{% extends 'base.html' %}{% block title %}Upload Results - {{ exam.name }}{% endblock %}{% block content %}<div class="container mx-auto p-4"><h1 class="text-3xl font-bold mb-6 text-center text-blue-800">Upload Results for {{ exam.name }}</h1><div class="bg-white p-8 rounded-xl shadow-lg max-w-lg mx-auto">
    <form method="POST" enctype="multipart/form-data" action="{% url 'exams:upload_results' exam.id %}" class="space-y-6">
        {% csrf_token %}
        <div>
            <label for="results_file" class="block text-sm font-medium text-gray-700">CSV File</label>
            <input type="file" id="results_file" name="results_file" required class="mt-1 block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-full file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100">
        </div>
        <p class="text-sm text-gray-500 mt-2">
            Accepted CSV format: `admission_number,subject_name,marks`
        </p>
        <div class="flex justify-end space-x-4">
            <button type="button" onclick="window.history.back()" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">Cancel</button>
            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-full shadow-md transition-colors duration-300">
                Upload
            </button>
        </div>
    </form> 
</div>
</div>{% endblock %}

this is another app called students

students/templates/students/advancement_bulk_upload.html
{% extends 'base.html' %}
{% load static %}

{% block title %}Bulk Upload Student Advancement Records{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col">
            <h2>Bulk Upload Student Advancement Records</h2>
        </div>
        <div class="col-auto">
            <a href="{% url 'student-advancement-list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
            <a href="{% url 'student-advancement-template' %}" class="btn btn-outline-primary">
                <i class="fas fa-download"></i> Download Template
            </a>
        </div>
    </div>

    {% if messages %}
    <div class="messages mb-4">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="card">
        <div class="card-body">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle"></i> Instructions</h5>
                <ol>
                    <li>Download the template Excel file using the button above</li>
                    <li>Fill in the student advancement data following the format</li>
                    <li>Save the file and upload it using the form below</li>
                    <li>Make sure to enter the correct academic year</li>
                </ol>
            </div>

            <form method="post" enctype="multipart/form-data" class="row g-3">
                {% csrf_token %}
                
                {% for field in form %}
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="{{ field.id_for_label }}" class="form-label">
                            {{ field.label }}
                        </label>
                        {{ field }}
                        {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                        {% endif %}
                        {% if field.errors %}
                        <div class="alert alert-danger mt-2">
                            {{ field.errors }}
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}

                <div class="col-12">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-upload"></i> Upload and Process
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    // Add Bootstrap classes to form fields
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('input[type="text"]').forEach(function(input) {
            input.classList.add('form-control');
        });
        
        document.querySelectorAll('input[type="file"]').forEach(function(input) {
            input.classList.add('form-control');
        });
    });
</script>
{% endblock %}
{% endblock %}

students/templates/students/advancement_form.html
{% extends 'base.html' %}
{% load static %}

{% block title %}Create Student Advancement Record{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col">
            <h2>Create Student Advancement Record</h2>
        </div>
        <div class="col-auto">
            <a href="{% url 'student-advancement-list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
        </div>
    </div>

    {% if messages %}
    <div class="messages mb-4">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="card">
        <div class="card-body">
            <form method="post" class="row g-3">
                {% csrf_token %}
                
                {% for field in form %}
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="{{ field.id_for_label }}" class="form-label">
                            {{ field.label }}
                        </label>
                        {{ field }}
                        {% if field.help_text %}
                        <small class="form-text text-muted">{{ field.help_text }}</small>
                        {% endif %}
                        {% if field.errors %}
                        <div class="alert alert-danger mt-2">
                            {{ field.errors }}
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}

                <div class="col-12">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Record
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    // Add Bootstrap classes to form fields
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('select').forEach(function(select) {
            select.classList.add('form-select');
        });
        
        document.querySelectorAll('input[type="text"]').forEach(function(input) {
            input.classList.add('form-control');
        });
        
        document.querySelectorAll('textarea').forEach(function(textarea) {
            textarea.classList.add('form-control');
        });
    });
</script>
{% endblock %}
{% endblock %}

students/templates/students/advancement_list.html
{% extends 'base.html' %}
{% load static %}

{% block title %}Student Advancement Records{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row mb-4">
        <div class="col">
            <h2>Student Advancement Records</h2>
        </div>
        <div class="col-auto">
            <a href="{% url 'student-advancement-create' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Add Record
            </a>
            <a href="{% url 'student-advancement-bulk-upload' %}" class="btn btn-success">
                <i class="fas fa-file-excel"></i> Bulk Upload
            </a>
            <a href="{% url 'student-advancement-template' %}" class="btn btn-outline-secondary">
                <i class="fas fa-download"></i> Download Template
            </a>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-body">
            <form method="get" class="row g-3">
                <div class="col-auto">
                    <select name="academic_year" class="form-select" onchange="this.form.submit()">
                        <option value="">All Academic Years</option>
                        {% for year in academic_years %}
                        <option value="{{ year }}" {% if request.GET.academic_year == year %}selected{% endif %}>
                            {{ year }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </form>
        </div>
    </div>

    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Admission No.</th>
                    <th>Name</th>
                    <th>Current Class</th>
                    <th>Next Class</th>
                    <th>Status</th>
                    <th>Academic Year</th>
                    <th>Decision Date</th>
                    <th>Remarks</th>
                </tr>
            </thead>
            <tbody>
                {% for advancement in advancements %}
                <tr>
                    <td>{{ advancement.student.admission_number }}</td>
                    <td>{{ advancement.student.name }}</td>
                    <td>Form {{ advancement.current_form }} {{ advancement.current_stream }}</td>
                    <td>Form {{ advancement.next_form }} {{ advancement.next_stream }}</td>
                    <td>
                        <span class="badge {% if advancement.status == 'promoted' %}bg-success
                                         {% elif advancement.status == 'retained' %}bg-warning
                                         {% elif advancement.status == 'graduated' %}bg-info
                                         {% else %}bg-secondary{% endif %}">
                            {{ advancement.get_status_display }}
                        </span>
                    </td>
                    <td>{{ advancement.academic_year }}</td>
                    <td>{{ advancement.decision_date }}</td>
                    <td>{{ advancement.remarks|truncatechars:30 }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="8" class="text-center">No advancement records found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

students/templates/students/bulk_advancement.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Bulk Student Advancement{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h2>Bulk Student Management</h2>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <form method="get" class="form-inline">
                        <select name="form_level" class="form-control mr-2">
                            <option value="">All Forms</option>
                            {% for form in form_levels %}
                            <option value="{{ form }}" {% if form == selected_form %}selected{% endif %}>Form {{ form }}</option>
                            {% endfor %}
                        </select>
                        <select name="stream" class="form-control mr-2">
                            <option value="">All Streams</option>
                            {% for stream in streams %}
                            <option value="{{ stream }}" {% if stream == selected_stream %}selected{% endif %}>{{ stream }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit" class="btn btn-primary">Filter</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <form method="post">
        {% csrf_token %}
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll"></th>
                                <th>Admission No</th>
                                <th>Name</th>
                                <th>Form</th>
                                <th>Stream</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                            <tr>
                                <td><input type="checkbox" name="selected_students" value="{{ student.admission_number }}"></td>
                                <td>{{ student.admission_number }}</td>
                                <td>{{ student.full_name }}</td>
                                <td>{{ student.form_level }}</td>
                                <td>{{ student.stream }}</td>
                                <td>{% if student.active %}Active{% else %}Graduated{% endif %}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="6" class="text-center">No students found</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer">
                <div class="row">
                    <div class="col-md-4">
                        <button type="submit" name="action" value="advance_form" class="btn btn-success">
                            <i class="fas fa-arrow-up"></i> Advance Form Level
                        </button>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <select name="new_stream" class="form-control">
                                {% for stream in streams %}
                                <option value="{{ stream }}">{{ stream }}</option>
                                {% endfor %}
                            </select>
                            <div class="input-group-append">
                                <button type="submit" name="action" value="change_stream" class="btn btn-info">
                                    Change Stream
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <button type="submit" name="action" value="graduate" class="btn btn-warning">
                            <i class="fas fa-graduation-cap"></i> Mark as Graduated
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
document.getElementById('selectAll').addEventListener('change', function() {
    const checkboxes = document.getElementsByName('selected_students');
    checkboxes.forEach(checkbox => checkbox.checked = this.checked);
});
</script>
{% endblock %}

students/templates/students/dashboard.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Dashboard - Exam System{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h1>Friends Kikai Boys High School</h1>
            <h3>Examination Management System</h3>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="card bg-primary text-white mb-4">
                <div class="card-body">
                    <h4>{{ total_students }}</h4>
                    <p>Total Students</p>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white" href="{% url 'students:student_list' %}">View Details</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white mb-4">
                <div class="card-body">
                    <h4>{{ form_counts|length }}</h4>
                    <p>Forms</p>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white" href="{% url 'students:bulk_advancement' %}">Manage Forms</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white mb-4">
                <div class="card-body">
                    <h4>{{ recent_exams|length }}</h4>
                    <p>Recent Exams</p>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white" href="#exam-list">View Exams</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white mb-4">
                <div class="card-body">
                    <h4>{{ total_subjects }}</h4>
                    <p>Subjects</p>
                </div>
                <div class="card-footer d-flex align-items-center justify-content-between">
                    <a class="small text-white" href="#subject-list">View Subjects</a>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Students by Form</h5>
            </div>
            <div class="card-body">
                {% for form in form_counts %}
                <div class="d-flex justify-content-between mb-2">
                    <span>Form {{ form.form_level }}</span>
                    <span class="badge badge-primary">{{ form.count }} students</span>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Recent Exams</h5>
            </div>
            <div class="card-body">
                {% for exam in recent_exams %}
                <div class="d-flex justify-content-between mb-2">
                    <div>
                        <strong>{{ exam.name }}</strong><br>
                        <small class="text-muted">Form {{ exam.form_level }} - {{ exam.get_exam_type_display }}</small>
                    </div>
                    <a href="{% url 'exams:exam_detail' exam.id %}" class="btn btn-sm btn-outline-primary">View</a>
                </div>
                {% empty %}
                <p class="text-muted">No recent exams found.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5>Quick Actions</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <a href="{% url 'students:student_list' %}" class="btn btn-block btn-outline-primary">
                            <i class="fa fa-users"></i> View Students
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{% url 'exams:exam_list' %}" class="btn btn-block btn-outline-success">
                            <i class="fa fa-file-text"></i> View Exams
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="{% url 'admin:index' %}" class="btn btn-block btn-outline-info">
                            <i class="fa fa-cog"></i> Admin Panel
                        </a>
                    </div>
                    <div class="col-md-3">
                        {% if recent_exams %}
                        <a href="{% url 'students:merit_list' recent_exams.0.id %}" class="btn btn-block btn-outline-warning">
                            <i class="fa fa-trophy"></i> Merit Lists
                        </a>
                        {% else %}
                        <button class="btn btn-block btn-outline-secondary" disabled>
                            <i class="fa fa-trophy"></i> Merit Lists
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

students/templates/students/merit_list.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Merit List - {{ exam.name }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Merit List - {{ exam.name }}</h1>
    <div>
        <a href="{% url 'exams:exam_detail' exam.id %}" class="btn btn-secondary">Back to Exam</a>
    </div>
</div>

<div class="card mb-4">
    <div class="card-body">
        <form method="get" class="form-inline">
            <div class="form-group mr-3">
                <label for="stream" class="mr-2">Stream:</label>
                <select name="stream" id="stream" class="form-control">
                    <option value="">All Streams</option>
                    {% for stream in streams %}
                        <option value="{{ stream }}" {% if stream == selected_stream %}selected{% endif %}>
                            {{ stream }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" class="btn btn-secondary">Filter</button>
            <a href="{% url 'students:merit_list' exam.id %}" class="btn btn-outline-secondary ml-2">Clear</a>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5>{{ exam.name }} - Form {{ exam.form_level }} Merit List</h5>
        <small class="text-muted">{{ exam.year }} Term {{ exam.term }}</small>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-sm">
                <thead>
                    <tr>
                        <th>Position</th>
                        <th>Adm. No.</th>
                        <th>Name</th>
                        <th>Stream</th>
                        <th>Total Marks</th>
                        <th>Mean Marks</th>
                        <th>Mean Grade</th>
                        <th>Total Points</th>
                        <th>Subjects</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for summary in summaries %}
                    <tr class="grade-{{ summary.mean_grade }}">
                        <td>
                            <strong>
                                {% if selected_stream %}
                                    {{ summary.stream_position|default:"-" }}
                                {% else %}
                                    {{ summary.overall_position|default:"-" }}
                                {% endif %}
                            </strong>
                        </td>
                        <td>{{ summary.student.admission_number }}</td>
                        <td>{{ summary.student.name }}</td>
                        <td>
                            <span class="badge badge-info">{{ summary.student.stream }}</span>
                        </td>
                        <td>{{ summary.total_marks }}</td>
                        <td>{{ summary.mean_marks|floatformat:2 }}</td>
                        <td>
                            <span class="badge badge-secondary">{{ summary.mean_grade }}</span>
                        </td>
                        <td>{{ summary.total_points }}</td>
                        <td>{{ summary.subjects_count }}</td>
                        <td>
                            <a href="{% url 'students:student_detail' summary.student.admission_number %}" 
                               class="btn btn-sm btn-outline-primary">View</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="10" class="text-center text-muted">No students found for this exam.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

students/templates/students/performance_graph.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Student Performance - {{ student.full_name }}{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2>Performance Analysis - {{ student.full_name }}</h2>
            <p class="text-muted">Form {{ student.form_level }} {{ student.stream }}</p>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <canvas id="performanceChart"></canvas>
        </div>
    </div>
</div>

<script>
const ctx = document.getElementById('performanceChart').getContext('2d');
const examsData = {{ exams_data|safe }};

const datasets = [];
const labels = Object.keys(examsData);
const subjects = new Set();

// Get all unique subjects
Object.values(examsData).forEach(examResults => {
    Object.keys(examResults).forEach(subject => subjects.add(subject));
});

// Create datasets for each subject
subjects.forEach(subject => {
    const data = labels.map(exam => examsData[exam][subject] || null);
    datasets.push({
        label: subject,
        data: data,
        fill: false,
        tension: 0.1
    });
});

new Chart(ctx, {
    type: 'line',
    data: {
        labels: labels,
        datasets: datasets
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true,
                max: 100
            }
        },
        plugins: {
            title: {
                display: true,
                text: 'Subject Performance Over Time'
            }
        }
    }
});
</script>
{% endblock %}

students/templates/students/report_card.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Report Card - {{ student.full_name }}{% endblock %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0">Friends Kikai Boys High School</h3>
            <p class="mb-0">Report Card</p>
        </div>
        <div class="card-body">
            <div class="row mb-4">
                <div class="col-6">
                    <p><strong>Student:</strong> {{ student.full_name }}</p>
                    <p><strong>Admission No:</strong> {{ student.admission_number }}</p>
                    <p><strong>Form:</strong> {{ student.form_level }} {{ student.stream }}</p>
                </div>
                <div class="col-6 text-right">
                    <p><strong>Exam:</strong> {{ exam.name }}</p>
                    <p><strong>Year:</strong> {{ exam.year }}</p>
                    <p><strong>Term:</strong> {{ exam.term }}</p>
                </div>
            </div>

            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Subject</th>
                        <th>Marks</th>
                        <th>Grade</th>
                        <th>Teacher's Comment</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in results %}
                    <tr>
                        <td>{{ result.subject.name }}</td>
                        <td>{{ result.total_marks }}</td>
                        <td>{{ result.get_grade }}</td>
                        <td>{{ result.teacher_comment|default:"-" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div class="row mt-4">
                <div class="col-md-6">
                    <h5>Performance Summary</h5>
                    <p><strong>Total Marks:</strong> {{ summary.total_marks }}</p>
                    <p><strong>Mean Grade:</strong> {{ summary.mean_grade }}</p>
                    <p><strong>Mean Points:</strong> {{ summary.mean_points }}</p>
                </div>
                <div class="col-md-6">
                    <h5>Class Position</h5>
                    <p><strong>Overall Position:</strong> {{ summary.overall_position }} out of {{ summary.total_students }}</p>
                    <p><strong>Stream Position:</strong> {{ summary.stream_position }} out of {{ summary.stream_students }}</p>
                </div>
            </div>

            <div class="mt-4">
                <h5>Principal's Comments</h5>
                <p>{{ summary.principal_comment|default:"Keep working hard!" }}</p>
            </div>
        </div>
    </div>

    <div class="mt-3 text-right">
        <button onclick="window.print()" class="btn btn-primary">
            <i class="fas fa-print"></i> Print Report
        </button>
        <a href="{% url 'students:performance_graph' student.admission_number %}" class="btn btn-info">
            <i class="fas fa-chart-line"></i> View Performance Graph
        </a>
    </div>
</div>
{% endblock %}

students/templates/students/student_confirm_delete.html
{% extends 'base.html' %}
{% block title %}Confirm Delete{% endblock %}
{% block content %}
    <h2>Confirm Delete</h2>
    <p>Are you sure you want to delete the student **{{ object.name }}** with admission number **{{ object.admission_number }}**?</p>
    <form method="post">
        {% csrf_token %}
        <button type="submit">Yes, delete</button>
        <a href="{% url 'students:student_detail' object.admission_number %}">Cancel</a>
    </form>
{% endblock %}

students/templates/students/student_detail.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}{{ student.full_name }} - Student Details{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-3">
            <div class="card mb-4">
                <div class="card-header">
                    <h4 class="mb-0">Student Information</h4>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <i class="fas fa-user-graduate fa-4x text-primary"></i>
                    </div>
                    <table class="table table-sm">
                        <tr>
                            <th>Name:</th>
                            <td>{{ student.full_name }}</td>
                        </tr>
                        <tr>
                            <th>Admission No:</th>
                            <td>{{ student.admission_number }}</td>
                        </tr>
                        <tr>
                            <th>Form:</th>
                            <td>{{ student.form_level }} {{ student.stream }}</td>
                        </tr>
                        <tr>
                            <th>Status:</th>
                            <td>
                                <span class="badge badge-{% if student.active %}success{% else %}secondary{% endif %}">
                                    {% if student.active %}Active{% else %}Graduated{% endif %}
                                </span>
                            </td>
                        </tr>
                    </table>
                    {% if perms.students.change_student %}
                    <div class="mt-3">
                        {% comment %} <a href="{% url 'students:student_update' student.admission_number %}" class="btn btn-primary btn-block">
                            <i class="fas fa-edit"></i> Edit Details
                        </a> {% endcomment %}
                        <a href="{% url 'students:student_edit' student.admission_number %}"class="btn btn-sm btn-outline-secondary" <i class="fas fa-edit"> </i>Edit</a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">Enrolled Subjects</h4>
                </div>
                <div class="card-body">
                    <ul class="list-group">
                        {% for enrollment in student.subject_enrollments.all %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ enrollment.subject.name }}
                            {% if enrollment.is_enrolled %}
                            <span class="badge badge-success">Enrolled</span>
                            {% endif %}
                        </li>
                        {% empty %}
                        <li class="list-group-item text-center text-muted">No subjects enrolled</li>
                        {% endfor %}
                    </ul>
                    {% if perms.students.change_student %}
                    <div class="mt-3">
                        <a href="{% url 'students:student_subjects' student.admission_number %}" class="btn btn-info btn-block">
                            <i class="fas fa-book"></i> Manage Subjects
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-9">
            <div class="card mb-4">
                <div class="card-header">
                    <h4 class="mb-0">Recent Exams</h4>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Exam</th>
                                    <th>Term</th>
                                    <th>Mean Grade</th>
                                    <th>Position</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for summary in student.exam_summaries.all|slice:":5" %}
                                <tr>
                                    <td>{{ summary.exam.name }}</td>
                                    <td>Term {{ summary.exam.term }}, {{ summary.exam.year }}</td>
                                    <td>{{ summary.mean_grade }}</td>
                                    <td>{{ summary.stream_position }} / {{ summary.stream_students }}</td>
                                    <td>
                                        <a href="{% url 'students:report_card' student.admission_number summary.exam.id %}" class="btn btn-sm btn-primary">
                                            <i class="fas fa-file-alt"></i> Report Card
                                        </a>
                                    </td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center text-muted">No exam results found</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">Performance Graph</h4>
                </div>
                <div class="card-body">
                    <div id="performanceChart">
                        <a href="{% url 'students:performance_graph' student.admission_number %}" class="btn btn-primary">
                            <i class="fas fa-chart-line"></i> View Full Performance Analysis
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

students/templates/students/student_form.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}{% if form.instance.pk %}Edit{% else %}New{% endif %} Student{% endblock %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="card-header">
            <h3>{% if form.instance.pk %}Edit{% else %}New{% endif %} Student</h3>
        </div>
        <div class="card-body">
            <form method="post" class="form">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-6">
                        {% bootstrap_field form.name %}
                        
                        {% bootstrap_field form.admission_number %}
                        {% bootstrap_field form.form_level %}
                    </div>
                    <div class="col-md-6">
                        {% bootstrap_field form.stream %}
                        
                        
                        {% if form.instance.pk and not form.instance.active %}
                            
                        {% endif %}
                    </div>
                </div>
                
                <div class="mt-3">
                    <button type="submit" class="btn btn-primary">
                        {% if form.instance.pk %}Save Changes{% else %}Create Student{% endif %}
                    </button>
                    <a href="{% url 'students:student_list' %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
document.getElementById('id_active').addEventListener('change', function() {
    const graduatedField = document.getElementById('id_date_graduated').closest('.form-group');
    if (!this.checked) {
        graduatedField.style.display = 'block';
    } else {
        graduatedField.style.display = 'none';
    }
});
</script>
{% endblock %}
{% endblock %}

students/templates/students/student_list.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Students - Exam System{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Student Management</h1>
    <div>
        <a href="{% url 'students:student_create' %}" class="btn btn-primary">Add Student</a>
    </div>
</div>

<!-- Filter Form -->
<div class="card mb-4">
    <div class="card-body">
        <form method="get" class="form-inline">
            <div class="form-group mr-3">
                <label for="form_level" class="mr-2">Form:</label>
                <select name="form_level" id="form_level" class="form-control">
                    <option value="">All Forms</option>
                    {% for form in form_levels %}
                        <option value="{{ form }}" {% if form|stringformat:"s" == selected_form %}selected{% endif %}>
                            Form {{ form }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group mr-3">
                <label for="stream" class="mr-2">Stream:</label>
                <select name="stream" id="stream" class="form-control">
                    <option value="">All Streams</option>
                    {% for stream in streams %}
                        <option value="{{ stream }}" {% if stream == selected_stream %}selected{% endif %}>
                            {{ stream }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group mr-3">
                <label for="search" class="mr-2">Search:</label>
                <input type="text" name="search" id="search" class="form-control" 
                       placeholder="Name or Admission No." value="{{ search_query }}">
            </div>
            
            <button type="submit" class="btn btn-secondary">Filter</button>
            <a href="{% url 'students:student_list' %}" class="btn btn-outline-secondary ml-2">Clear</a>
        </form>
    </div>
</div>

<!-- Students Table -->
<div class="card">
    <div class="card-header">
        <h5>Students ({{ students|length }} found)</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Admission No.</th>
                        <th>Name</th>
                        <th>Form & Stream</th>
                        <th>KCPE Marks</th>
                        <th>Contact</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td><strong>{{ student.admission_number }}</strong></td>
                        <td>{{ student.name }}</td>
                        <td>
                            <span class="badge badge-info">Form {{ student.form_level }} {{ student.stream }}</span>
                        </td>
                        <td>
                            {% if student.kcpe_marks %}
                                <span class="badge badge-success">{{ student.kcpe_marks }}</span>
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>{{ student.phone_contact|default:"-" }}</td>
                        <td>
                            <a href="{% url 'students:student_detail' student.admission_number %}" 
                               class="btn btn-sm btn-outline-primary">View</a>
                            {% comment %} <a href="{% url 'admin:students_student_change' student.id %}" 
                               class="btn btn-sm btn-outline-secondary">Edit</a> {% endcomment %}
                            <a href="{% url 'students:student_edit' student.admission_number %}"class="btn btn-sm btn-outline-secondary">Edit</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="6" class="text-center text-muted">No students found matching your criteria.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

students/templates/students/student_subject_enrollment.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Subject Enrollment - {{ student.full_name }}{% endblock %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="card-header">
            <h3>Subject Enrollment</h3>
            <p class="mb-0">{{ student.full_name }} - Form {{ student.form_level }} {{ student.stream }}</p>
        </div>
        <div class="card-body">
            <form method="post">
                {% csrf_token %}
                
                {% regroup subjects by category as subject_groups %}
                
                {% for group in subject_groups %}
                <div class="card mb-3">
                    <div class="card-header">
                        <h5 class="mb-0">{{ group.grouper|default:"Core Subjects" }}</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% for subject in group.list %}
                            <div class="col-md-4 mb-2">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" 
                                           class="custom-control-input" 
                                           id="subject_{{ subject.id }}"
                                           name="subjects" 
                                           value="{{ subject.id }}"
                                           {% if subject.id in enrolled_subjects %}checked{% endif %}
                                           {% if subject.is_mandatory %}disabled checked{% endif %}>
                                    <label class="custom-control-label" for="subject_{{ subject.id }}">
                                        {{ subject.name }}
                                        {% if subject.is_mandatory %}
                                        <span class="badge badge-info">Mandatory</span>
                                        {% endif %}
                                    </label>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% endfor %}

                <div class="alert alert-info">
                    <h5>Selection Rules:</h5>
                    <ul>
                        <li>Core subjects are mandatory</li>
                        <li>Select at least 2 sciences</li>
                        <li>Total subjects should be between 7 and 9</li>
                    </ul>
                </div>

                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-primary">Save Subject Selection</button>
                    <a href="{% url 'students:student_detail' student.admission_number %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    // Count selected subjects
    function updateSubjectCount() {
        const selected = document.querySelectorAll('input[name="subjects"]:checked').length;
        const warning = document.getElementById('subject-warning');
        if (selected < 7 || selected > 9) {
            warning.style.display = 'block';
        } else {
            warning.style.display = 'none';
        }
    }

    // Add event listeners to checkboxes
    document.querySelectorAll('input[name="subjects"]').forEach(checkbox => {
        checkbox.addEventListener('change', updateSubjectCount);
    });

    // Initial count
    updateSubjectCount();
</script>
{% endblock %}
{% endblock %}

students/templates/students/student_subjects.html
{% extends 'base.html' %}
{% load bootstrap4 %}

{% block title %}Student Subject Management{% endblock %}

{% block content %}
<div class="container">
    <div class="card">
        <div class="card-header">
            <h3>Manage Subjects for {{ student.full_name }}</h3>
            <p class="text-muted mb-0">Form {{ student.form_level }} {{ student.stream }}</p>
        </div>
        <div class="card-body">
            <form method="post" class="form">
                {% csrf_token %}
                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i> Select the subjects this student will be enrolled in.
                        </div>
                    </div>
                </div>
                
                <div class="subject-groups">
                    {% regroup available_subjects by category as subject_categories %}
                    {% for category in subject_categories %}
                    <div class="card mb-3">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">{{ category.grouper }}</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                {% for subject in category.list %}
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input type="checkbox" name="subjects" value="{{ subject.id }}"
                                               class="form-check-input" id="subject_{{ subject.id }}"
                                               {% if subject in enrolled_subjects %}checked{% endif %}>
                                        <label class="form-check-label" for="subject_{{ subject.id }}">
                                            {{ subject.name }}
                                        </label>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <div class="mt-3">
                    <button type="submit" class="btn btn-primary">Save Subject Selection</button>
                    <a href="{% url 'students:student_detail' student.admission_number %}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

subjects and report im lucking templates 